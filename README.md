# Coffee Brewing System

Система приготовления кофе с расчетом стоимости и формальным доказательством ограничений цены.

## Бизнес-логика

Система моделирует процесс приготовления кофе со следующими правилами:

1. **Базовая цена** = цена зерен + цена молока
2. **Надбавка бариста** = 5.xxx%, где xxx - количество секунд варки зерен
3. **Итоговая цена** = базовая цена + надбавка бариста
4. **Ограничение**: итоговая цена не может превышать 100 условных единиц

## Структура проекта

### PHP Implementation (`php/`)

- **Beans/** - классы зерен кофе
  - `BeansInterface.php` - интерфейс зерен
  - `ArabicaBeans.php` - зерна арабики (45 у.е., 120 сек)
  - `RobustaBeans.php` - зерна робусты (30 у.е., 90 сек)

- **Milk/** - классы молока
  - `MilkInterface.php` - интерфейс молока
  - `WholeMilk.php` - цельное молоко (15 у.е.)
  - `AlmondMilk.php` - миндальное молоко (25 у.е.)

- **Service/** - бизнес-логика
  - `CoffeeService.php` - сервис приготовления кофе

### Isabelle/HOL Theory (`Isabelle/`)

- `Coffee.thy` - формальная модель системы с доказательством

## Результаты расчетов

| Зерна | Молоко | Базовая цена | Время варки | Надбавка | Итого |
|-------|--------|--------------|-------------|----------|-------|
| Arabica | Whole Milk | 60 | 120 сек | 5.12% | **63.07** |
| Arabica | Almond Milk | 70 | 120 сек | 5.12% | **73.58** |
| Robusta | Whole Milk | 45 | 90 сек | 5.09% | **47.29** |
| Robusta | Almond Milk | 55 | 90 сек | 5.09% | **57.80** |

**Максимальная цена**: 73.58 у.е. (Arabica + Almond Milk)
**Лимит системы**: 100 у.е.
**Запас**: 26.42 у.е.

## Формальное доказательство

В теории Isabelle/HOL доказана теорема:

```isabelle
theorem coffee_price_bounded:
  "∀b m. coffee_price b m ≤ max_price"
```

Это означает, что **не существует** такой комбинации зерен и молока, при которой итоговая цена превысит максимально допустимую (100 у.е.).

### Структурный подход к доказательству

Доказательство использует **структурный анализ**, а не жесткие константы:

1. **Верхние границы**: Находим максимальные цены среди всех ингредиентов
2. **Общая формула**: `цена ≤ (max_зерна + max_молоко) × (1 + max_надбавка)`
3. **Гибкость**: При изменении цен нужно изменить только определения, доказательство остается валидным

**Дополнительные гарантии:**
- Максимум достигается на самых дорогих ингредиентах (Arabica + Almond Milk)
- Цена монотонно растет с ростом цен ингредиентов  
- Значительный запас безопасности (>25 у.е.)

## Запуск

### PHP система
```bash
cd php
composer install
php example.php
```

### Isabelle доказательство
```bash
cd Isabelle
isabelle build -D .
```

## Заключение

Система гарантирует, что все возможные комбинации кофе остаются в рамках бюджета. Максимальная цена составляет всего 73.6% от лимита, что обеспечивает значительный запас безопасности. 